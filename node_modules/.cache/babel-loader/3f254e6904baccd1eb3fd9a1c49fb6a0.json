{"ast":null,"code":"'use strict';\n\nvar hash = require('hash.js');\nvar elliptic = require('../elliptic');\nvar utils = elliptic.utils;\nvar assert = utils.assert;\nfunction HmacDRBG(options) {\n  if (!(this instanceof HmacDRBG)) return new HmacDRBG(options);\n  this.hash = options.hash;\n  this.predResist = !!options.predResist;\n  this.outLen = this.hash.outSize;\n  this.minEntropy = options.minEntropy || this.hash.hmacStrength;\n  this.reseed = null;\n  this.reseedInterval = null;\n  this.K = null;\n  this.V = null;\n  var entropy = utils.toArray(options.entropy, options.entropyEnc);\n  var nonce = utils.toArray(options.nonce, options.nonceEnc);\n  var pers = utils.toArray(options.pers, options.persEnc);\n  assert(entropy.length >= this.minEntropy / 8, 'Not enough entropy. Minimum is: ' + this.minEntropy + ' bits');\n  this._init(entropy, nonce, pers);\n}\nmodule.exports = HmacDRBG;\nHmacDRBG.prototype._init = function init(entropy, nonce, pers) {\n  var seed = entropy.concat(nonce).concat(pers);\n  this.K = new Array(this.outLen / 8);\n  this.V = new Array(this.outLen / 8);\n  for (var i = 0; i < this.V.length; i++) {\n    this.K[i] = 0x00;\n    this.V[i] = 0x01;\n  }\n  this._update(seed);\n  this.reseed = 1;\n  this.reseedInterval = 0x1000000000000; // 2^48\n};\n\nHmacDRBG.prototype._hmac = function hmac() {\n  return new hash.hmac(this.hash, this.K);\n};\nHmacDRBG.prototype._update = function update(seed) {\n  var kmac = this._hmac().update(this.V).update([0x00]);\n  if (seed) kmac = kmac.update(seed);\n  this.K = kmac.digest();\n  this.V = this._hmac().update(this.V).digest();\n  if (!seed) return;\n  this.K = this._hmac().update(this.V).update([0x01]).update(seed).digest();\n  this.V = this._hmac().update(this.V).digest();\n};\nHmacDRBG.prototype.reseed = function reseed(entropy, entropyEnc, add, addEnc) {\n  // Optional entropy enc\n  if (typeof entropyEnc !== 'string') {\n    addEnc = add;\n    add = entropyEnc;\n    entropyEnc = null;\n  }\n  entropy = utils.toBuffer(entropy, entropyEnc);\n  add = utils.toBuffer(add, addEnc);\n  assert(entropy.length >= this.minEntropy / 8, 'Not enough entropy. Minimum is: ' + this.minEntropy + ' bits');\n  this._update(entropy.concat(add || []));\n  this.reseed = 1;\n};\nHmacDRBG.prototype.generate = function generate(len, enc, add, addEnc) {\n  if (this.reseed > this.reseedInterval) throw new Error('Reseed is required');\n\n  // Optional encoding\n  if (typeof enc !== 'string') {\n    addEnc = add;\n    add = enc;\n    enc = null;\n  }\n\n  // Optional additional data\n  if (add) {\n    add = utils.toArray(add, addEnc);\n    this._update(add);\n  }\n  var temp = [];\n  while (temp.length < len) {\n    this.V = this._hmac().update(this.V).digest();\n    temp = temp.concat(this.V);\n  }\n  var res = temp.slice(0, len);\n  this._update(add);\n  this.reseed++;\n  return utils.encode(res, enc);\n};","map":{"version":3,"names":["hash","require","elliptic","utils","assert","HmacDRBG","options","predResist","outLen","outSize","minEntropy","hmacStrength","reseed","reseedInterval","K","V","entropy","toArray","entropyEnc","nonce","nonceEnc","pers","persEnc","length","_init","module","exports","prototype","init","seed","concat","Array","i","_update","_hmac","hmac","update","kmac","digest","add","addEnc","toBuffer","generate","len","enc","Error","temp","res","slice","encode"],"sources":["C:/Users/Elton/OneDrive/Desktop/baseapp-2024/node_modules/bitcoincashjs/node_modules/elliptic/lib/elliptic/hmac-drbg.js"],"sourcesContent":["'use strict';\n\nvar hash = require('hash.js');\nvar elliptic = require('../elliptic');\nvar utils = elliptic.utils;\nvar assert = utils.assert;\n\nfunction HmacDRBG(options) {\n  if (!(this instanceof HmacDRBG))\n    return new HmacDRBG(options);\n  this.hash = options.hash;\n  this.predResist = !!options.predResist;\n\n  this.outLen = this.hash.outSize;\n  this.minEntropy = options.minEntropy || this.hash.hmacStrength;\n\n  this.reseed = null;\n  this.reseedInterval = null;\n  this.K = null;\n  this.V = null;\n\n  var entropy = utils.toArray(options.entropy, options.entropyEnc);\n  var nonce = utils.toArray(options.nonce, options.nonceEnc);\n  var pers = utils.toArray(options.pers, options.persEnc);\n  assert(entropy.length >= (this.minEntropy / 8),\n         'Not enough entropy. Minimum is: ' + this.minEntropy + ' bits');\n  this._init(entropy, nonce, pers);\n}\nmodule.exports = HmacDRBG;\n\nHmacDRBG.prototype._init = function init(entropy, nonce, pers) {\n  var seed = entropy.concat(nonce).concat(pers);\n\n  this.K = new Array(this.outLen / 8);\n  this.V = new Array(this.outLen / 8);\n  for (var i = 0; i < this.V.length; i++) {\n    this.K[i] = 0x00;\n    this.V[i] = 0x01;\n  }\n\n  this._update(seed);\n  this.reseed = 1;\n  this.reseedInterval = 0x1000000000000;  // 2^48\n};\n\nHmacDRBG.prototype._hmac = function hmac() {\n  return new hash.hmac(this.hash, this.K);\n};\n\nHmacDRBG.prototype._update = function update(seed) {\n  var kmac = this._hmac()\n                 .update(this.V)\n                 .update([ 0x00 ]);\n  if (seed)\n    kmac = kmac.update(seed);\n  this.K = kmac.digest();\n  this.V = this._hmac().update(this.V).digest();\n  if (!seed)\n    return;\n\n  this.K = this._hmac()\n               .update(this.V)\n               .update([ 0x01 ])\n               .update(seed)\n               .digest();\n  this.V = this._hmac().update(this.V).digest();\n};\n\nHmacDRBG.prototype.reseed = function reseed(entropy, entropyEnc, add, addEnc) {\n  // Optional entropy enc\n  if (typeof entropyEnc !== 'string') {\n    addEnc = add;\n    add = entropyEnc;\n    entropyEnc = null;\n  }\n\n  entropy = utils.toBuffer(entropy, entropyEnc);\n  add = utils.toBuffer(add, addEnc);\n\n  assert(entropy.length >= (this.minEntropy / 8),\n         'Not enough entropy. Minimum is: ' + this.minEntropy + ' bits');\n\n  this._update(entropy.concat(add || []));\n  this.reseed = 1;\n};\n\nHmacDRBG.prototype.generate = function generate(len, enc, add, addEnc) {\n  if (this.reseed > this.reseedInterval)\n    throw new Error('Reseed is required');\n\n  // Optional encoding\n  if (typeof enc !== 'string') {\n    addEnc = add;\n    add = enc;\n    enc = null;\n  }\n\n  // Optional additional data\n  if (add) {\n    add = utils.toArray(add, addEnc);\n    this._update(add);\n  }\n\n  var temp = [];\n  while (temp.length < len) {\n    this.V = this._hmac().update(this.V).digest();\n    temp = temp.concat(this.V);\n  }\n\n  var res = temp.slice(0, len);\n  this._update(add);\n  this.reseed++;\n  return utils.encode(res, enc);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}