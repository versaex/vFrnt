{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\Elton\\\\OneDrive\\\\Desktop\\\\baseapp-2024\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport { isFinexEnabled } from '../../../api';\nimport { buildFilterPrice } from '../../../filters';\nimport { MARKETS_DATA, MARKETS_ERROR, MARKETS_FETCH, MARKETS_SET_CURRENT_MARKET, MARKETS_SET_CURRENT_MARKET_IFUNSET, MARKETS_TICKERS_DATA, MARKETS_TICKERS_ERROR, MARKETS_TICKERS_FETCH } from './constants';\nexport var initialMarketsState = {\n  list: [],\n  filters: {},\n  currentMarket: undefined,\n  tickers: {},\n  tickerLoading: false,\n  loading: false\n};\nexport var marketsReducer = function marketsReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialMarketsState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case MARKETS_FETCH:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        loading: true,\n        timestamp: Math.floor(Date.now() / 1000)\n      });\n    case MARKETS_DATA:\n      var filters = {};\n      if (isFinexEnabled() && action.payload) {\n        filters = action.payload.reduce(function (result, market) {\n          result[market.id] = result[market.id] || [];\n          if (market.filters) {\n            result[market.id] = market.filters.map(buildFilterPrice);\n          }\n          return result;\n        }, {});\n      }\n      return _objectSpread(_objectSpread({}, state), {}, {\n        loading: false,\n        list: action.payload,\n        filters: filters\n      });\n    case MARKETS_ERROR:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        loading: false\n      });\n    case MARKETS_SET_CURRENT_MARKET:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        currentMarket: action.payload\n      });\n    case MARKETS_SET_CURRENT_MARKET_IFUNSET:\n      if (state.currentMarket) {\n        return state;\n      }\n      return _objectSpread(_objectSpread({}, state), {}, {\n        currentMarket: action.payload\n      });\n    case MARKETS_TICKERS_FETCH:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        tickerLoading: true,\n        tickersTimestamp: Math.floor(Date.now() / 1000)\n      });\n    case MARKETS_TICKERS_DATA:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        tickerLoading: false,\n        tickers: action.payload\n      });\n    case MARKETS_TICKERS_ERROR:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        tickerLoading: false\n      });\n    default:\n      return state;\n  }\n};","map":{"version":3,"names":["isFinexEnabled","buildFilterPrice","MARKETS_DATA","MARKETS_ERROR","MARKETS_FETCH","MARKETS_SET_CURRENT_MARKET","MARKETS_SET_CURRENT_MARKET_IFUNSET","MARKETS_TICKERS_DATA","MARKETS_TICKERS_ERROR","MARKETS_TICKERS_FETCH","initialMarketsState","list","filters","currentMarket","undefined","tickers","tickerLoading","loading","marketsReducer","state","action","type","timestamp","Math","floor","Date","now","payload","reduce","result","market","id","map","tickersTimestamp"],"sources":["C:/Users/Elton/OneDrive/Desktop/baseapp-2024/src/modules/public/markets/reducer.ts"],"sourcesContent":["import { isFinexEnabled } from '../../../api';\nimport { buildFilterPrice, FilterPrice } from '../../../filters';\nimport { CommonState } from '../../types';\nimport { MarketsAction } from './actions';\nimport {\n    MARKETS_DATA,\n    MARKETS_ERROR,\n    MARKETS_FETCH,\n    MARKETS_SET_CURRENT_MARKET,\n    MARKETS_SET_CURRENT_MARKET_IFUNSET,\n    MARKETS_TICKERS_DATA,\n    MARKETS_TICKERS_ERROR,\n    MARKETS_TICKERS_FETCH,\n} from './constants';\nimport { Market, Ticker } from './types';\n\nexport interface MarketsState extends CommonState {\n    list: Market[];\n    filters: {\n        [marketId: string]: FilterPrice;\n    };\n    currentMarket: Market | undefined;\n    tickers: {\n        [pair: string]: Ticker;\n    };\n    tickerLoading: boolean;\n    loading: boolean;\n    timestamp?: number;\n    tickersTimestamp?: number;\n}\n\nexport const initialMarketsState: MarketsState = {\n    list: [],\n    filters: {},\n    currentMarket: undefined,\n    tickers: {},\n    tickerLoading: false,\n    loading: false,\n};\n\nexport const marketsReducer = (state = initialMarketsState, action: MarketsAction) => {\n    switch (action.type) {\n        case MARKETS_FETCH:\n            return {\n                ...state,\n                loading: true,\n                timestamp: Math.floor(Date.now() / 1000),\n            };\n        case MARKETS_DATA:\n            let filters = {};\n\n            if (isFinexEnabled() && action.payload) {\n                filters = action.payload.reduce((result, market: Market) => {\n                    result[market.id] = result[market.id] || [];\n\n                    if (market.filters) {\n                        result[market.id] = market.filters.map(buildFilterPrice);\n                    }\n\n                    return result;\n                }, {});\n            }\n\n            return {\n                ...state,\n                loading: false,\n                list: action.payload,\n                filters: filters,\n            };\n        case MARKETS_ERROR:\n            return {\n                ...state,\n                loading: false,\n            };\n\n        case MARKETS_SET_CURRENT_MARKET:\n            return {\n                ...state,\n                currentMarket: action.payload,\n            };\n\n        case MARKETS_SET_CURRENT_MARKET_IFUNSET:\n            if (state.currentMarket) {\n                return state;\n            }\n\n            return {\n                ...state,\n                currentMarket: action.payload,\n            };\n\n        case MARKETS_TICKERS_FETCH:\n            return {\n                ...state,\n                tickerLoading: true,\n                tickersTimestamp: Math.floor(Date.now() / 1000),\n            };\n        case MARKETS_TICKERS_DATA:\n            return {\n                ...state,\n                tickerLoading: false,\n                tickers: action.payload,\n            };\n        case MARKETS_TICKERS_ERROR:\n            return {\n                ...state,\n                tickerLoading: false,\n            };\n\n        default:\n            return state;\n    }\n};\n"],"mappings":";AAAA,SAASA,cAAc,QAAQ,cAAc;AAC7C,SAASC,gBAAgB,QAAqB,kBAAkB;AAGhE,SACIC,YAAY,EACZC,aAAa,EACbC,aAAa,EACbC,0BAA0B,EAC1BC,kCAAkC,EAClCC,oBAAoB,EACpBC,qBAAqB,EACrBC,qBAAqB,QAClB,aAAa;AAkBpB,OAAO,IAAMC,mBAAiC,GAAG;EAC7CC,IAAI,EAAE,EAAE;EACRC,OAAO,EAAE,CAAC,CAAC;EACXC,aAAa,EAAEC,SAAS;EACxBC,OAAO,EAAE,CAAC,CAAC;EACXC,aAAa,EAAE,KAAK;EACpBC,OAAO,EAAE;AACb,CAAC;AAED,OAAO,IAAMC,cAAc,GAAG,SAAjBA,cAAc,GAA2D;EAAA,IAAvDC,KAAK,uEAAGT,mBAAmB;EAAA,IAAEU,MAAqB;EAC7E,QAAQA,MAAM,CAACC,IAAI;IACf,KAAKjB,aAAa;MACd,uCACOe,KAAK;QACRF,OAAO,EAAE,IAAI;QACbK,SAAS,EAAEC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI;MAAC;IAEhD,KAAKxB,YAAY;MACb,IAAIU,OAAO,GAAG,CAAC,CAAC;MAEhB,IAAIZ,cAAc,EAAE,IAAIoB,MAAM,CAACO,OAAO,EAAE;QACpCf,OAAO,GAAGQ,MAAM,CAACO,OAAO,CAACC,MAAM,CAAC,UAACC,MAAM,EAAEC,MAAc,EAAK;UACxDD,MAAM,CAACC,MAAM,CAACC,EAAE,CAAC,GAAGF,MAAM,CAACC,MAAM,CAACC,EAAE,CAAC,IAAI,EAAE;UAE3C,IAAID,MAAM,CAAClB,OAAO,EAAE;YAChBiB,MAAM,CAACC,MAAM,CAACC,EAAE,CAAC,GAAGD,MAAM,CAAClB,OAAO,CAACoB,GAAG,CAAC/B,gBAAgB,CAAC;UAC5D;UAEA,OAAO4B,MAAM;QACjB,CAAC,EAAE,CAAC,CAAC,CAAC;MACV;MAEA,uCACOV,KAAK;QACRF,OAAO,EAAE,KAAK;QACdN,IAAI,EAAES,MAAM,CAACO,OAAO;QACpBf,OAAO,EAAEA;MAAO;IAExB,KAAKT,aAAa;MACd,uCACOgB,KAAK;QACRF,OAAO,EAAE;MAAK;IAGtB,KAAKZ,0BAA0B;MAC3B,uCACOc,KAAK;QACRN,aAAa,EAAEO,MAAM,CAACO;MAAO;IAGrC,KAAKrB,kCAAkC;MACnC,IAAIa,KAAK,CAACN,aAAa,EAAE;QACrB,OAAOM,KAAK;MAChB;MAEA,uCACOA,KAAK;QACRN,aAAa,EAAEO,MAAM,CAACO;MAAO;IAGrC,KAAKlB,qBAAqB;MACtB,uCACOU,KAAK;QACRH,aAAa,EAAE,IAAI;QACnBiB,gBAAgB,EAAEV,IAAI,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI;MAAC;IAEvD,KAAKnB,oBAAoB;MACrB,uCACOY,KAAK;QACRH,aAAa,EAAE,KAAK;QACpBD,OAAO,EAAEK,MAAM,CAACO;MAAO;IAE/B,KAAKnB,qBAAqB;MACtB,uCACOW,KAAK;QACRH,aAAa,EAAE;MAAK;IAG5B;MACI,OAAOG,KAAK;EAAC;AAEzB,CAAC"},"metadata":{},"sourceType":"module"}