{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\Elton\\\\OneDrive\\\\Desktop\\\\baseapp-2024\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"C:\\\\Users\\\\Elton\\\\OneDrive\\\\Desktop\\\\baseapp-2024\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport { defaultStorageLimit } from '../../../api';\nimport { sliceArray } from '../../../helpers';\nimport { RECENT_TRADES_DATA, RECENT_TRADES_ERROR, RECENT_TRADES_FETCH, RECENT_TRADES_PUSH } from './constants';\nvar initialState = {\n  list: [],\n  loading: false\n};\nexport var convertTradeEventToTrade = function convertTradeEventToTrade(market, trade) {\n  return {\n    market: market,\n    id: trade.tid,\n    created_at: new Date(trade.date * 1000).toISOString(),\n    taker_type: trade.taker_type,\n    price: String(trade.price),\n    amount: String(trade.amount)\n  };\n};\nexport var convertTradeEventList = function convertTradeEventList(market, trades) {\n  return trades.map(function (trade) {\n    return convertTradeEventToTrade(market, trade);\n  });\n};\nexport var extendTradeWithPriceChange = function extendTradeWithPriceChange(trade, prevTrade) {\n  if (trade) {\n    if (prevTrade) {\n      return _objectSpread(_objectSpread({}, trade), {}, {\n        price_change: String(+(trade === null || trade === void 0 ? void 0 : trade.price) - +(prevTrade === null || prevTrade === void 0 ? void 0 : prevTrade.price))\n      });\n    }\n    return trade;\n  }\n  return;\n};\nexport var recentTradesReducer = function recentTradesReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case RECENT_TRADES_DATA:\n      {\n        var _action$payload, _action$payload2;\n        return {\n          list: sliceArray(action.payload, defaultStorageLimit()),\n          loading: false,\n          lastTrade: extendTradeWithPriceChange((_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload[0], (_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2[1])\n        };\n      }\n    case RECENT_TRADES_ERROR:\n      {\n        return {\n          list: [],\n          loading: false,\n          error: action.error,\n          lastTrade: undefined\n        };\n      }\n    case RECENT_TRADES_FETCH:\n      {\n        return _objectSpread(_objectSpread({}, state), {}, {\n          loading: true\n        });\n      }\n    case RECENT_TRADES_PUSH:\n      {\n        var lastTrades = convertTradeEventList(action.payload.market, action.payload.trades);\n        var updatedList = [].concat(_toConsumableArray(lastTrades), _toConsumableArray(state.list));\n        return _objectSpread(_objectSpread({}, state), {}, {\n          list: sliceArray(updatedList, defaultStorageLimit()),\n          lastTrade: extendTradeWithPriceChange(updatedList === null || updatedList === void 0 ? void 0 : updatedList[0], updatedList === null || updatedList === void 0 ? void 0 : updatedList[1])\n        });\n      }\n    default:\n      return state;\n  }\n};","map":{"version":3,"names":["defaultStorageLimit","sliceArray","RECENT_TRADES_DATA","RECENT_TRADES_ERROR","RECENT_TRADES_FETCH","RECENT_TRADES_PUSH","initialState","list","loading","convertTradeEventToTrade","market","trade","id","tid","created_at","Date","date","toISOString","taker_type","price","String","amount","convertTradeEventList","trades","map","extendTradeWithPriceChange","prevTrade","price_change","recentTradesReducer","state","action","type","payload","lastTrade","error","undefined","lastTrades","updatedList"],"sources":["C:/Users/Elton/OneDrive/Desktop/baseapp-2024/src/modules/public/recentTrades/reducer.ts"],"sourcesContent":["import { defaultStorageLimit } from '../../../api';\nimport { sliceArray } from '../../../helpers';\nimport { CommonError } from '../../types';\nimport { PublicTrade } from '../../user/history';\nimport { RecentTradesActions } from './actions';\nimport { RECENT_TRADES_DATA, RECENT_TRADES_ERROR, RECENT_TRADES_FETCH, RECENT_TRADES_PUSH } from './constants';\nimport { PublicTradeEvent } from './types';\n\nexport interface RecentTradesState {\n    list: PublicTrade[];\n    loading: boolean;\n    lastTrade?: PublicTrade;\n    error?: CommonError;\n}\n\nconst initialState: RecentTradesState = {\n    list: [],\n    loading: false,\n};\n\nexport const convertTradeEventToTrade = (market: string, trade: PublicTradeEvent): PublicTrade => ({\n    market,\n    id: trade.tid,\n    created_at: new Date(trade.date * 1000).toISOString(),\n    taker_type: trade.taker_type,\n    price: String(trade.price),\n    amount: String(trade.amount),\n});\n\nexport const convertTradeEventList = (market: string, trades: PublicTradeEvent[]): PublicTrade[] =>\n    trades.map(trade => convertTradeEventToTrade(market, trade));\n\nexport const extendTradeWithPriceChange = (\n    trade?: PublicTrade,\n    prevTrade?: PublicTrade,\n): PublicTrade | undefined => {\n    if (trade) {\n        if (prevTrade) {\n            return {\n                ...trade,\n                price_change: String(+(trade?.price) - +(prevTrade?.price)),\n            };\n        }\n\n        return trade;\n    }\n\n    return;\n};\n\nexport const recentTradesReducer = (state = initialState, action: RecentTradesActions) => {\n    switch (action.type) {\n        case RECENT_TRADES_DATA: {\n            return {\n                list: sliceArray(action.payload, defaultStorageLimit()),\n                loading: false,\n                lastTrade: extendTradeWithPriceChange(action.payload?.[0], action.payload?.[1]),\n            };\n        }\n        case RECENT_TRADES_ERROR: {\n            return {\n                list: [],\n                loading: false,\n                error: action.error,\n                lastTrade: undefined,\n            };\n        }\n        case RECENT_TRADES_FETCH: {\n            return {\n                ...state,\n                loading: true,\n            };\n        }\n        case RECENT_TRADES_PUSH: {\n            const lastTrades = convertTradeEventList(action.payload.market, action.payload.trades);\n            const updatedList = [\n                ...lastTrades,\n                ...state.list,\n            ];\n\n            return {\n                ...state,\n                list: sliceArray(updatedList, defaultStorageLimit()),\n                lastTrade: extendTradeWithPriceChange(updatedList?.[0], updatedList?.[1]),\n            };\n        }\n        default:\n            return state;\n    }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}